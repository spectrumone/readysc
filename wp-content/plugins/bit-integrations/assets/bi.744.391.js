var U=Object.defineProperty;var C=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var q=(m,o,c)=>o in m?U(m,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):m[o]=c,x=(m,o)=>{for(var c in o||(o={}))H.call(o,c)&&q(m,c,o[c]);if(C)for(var c of C(o))K.call(o,c)&&q(m,c,o[c]);return m};import{r as u,u as Q,l as V,j as e}from"./main-165.js";import{b as v,d as X,_ as s,G as N,I as Y,F as Z}from"./bi.312.95.js";import{S as ee}from"./bi.354.971.js";import{r as te,F as se,a as ie,C as ae,c as ne,b as le,d as re,e as oe}from"./bi.932.787.js";import{p as I}from"./bi.784.760.js";import{T as M,t as ce}from"./bi.40.785.js";import"./bi.953.732.js";import"./bi.422.733.js";function je({formFields:m,setFlow:o,flow:c,allIntegURL:P}){var w;const[j,L]=u.useState([]),[g,y]=u.useState([]),S=Q(),{formID:D}=V(),[F,_]=u.useState(!1),[h,T]=u.useState(1),[A,p]=u.useState({show:!1}),[E,W]=u.useState({fields:[],files:[]}),[$,z]=u.useState({fields:[],files:[]}),[J,O]=u.useState({fields:[],files:[]}),{postCreation:d}=ce,[n,b]=u.useState({name:"WP Post Creation",type:"WP Post Creation",post_map:[{post_author:"logged_in_user"}],acf_map:[{}],acf_file_map:[{}],metabox_map:[{}],metabox_file_map:[{}],je_cpt_meta_map:[{}],je_cpt_file_map:[{}]}),f=(t,i)=>{const a=x({},n);a[t]=i,b(a)};u.useEffect(()=>{v({},"user/list").then(i=>{const{data:a}=i;L(a)}),v({},"post-types/list").then(i=>{const{data:a}=i;y(a)});const t=x({},n);t.post_map=I.filter(i=>i.required).map(i=>({formField:"",postField:i.key,required:i.required})),b(t)},[]);const B=(t,i)=>{const a=x({},n);a[t]=i,v({post_type:i},"customfield/list").then(R=>{const{data:l}=R;W({fields:l.acf_fields,files:l.acf_files}),z({fields:l.mb_fields,files:l.mb_files}),O({fields:l.je_cpt_fields,files:l.je_cpt_files}),l!=null&&l.acf_fields&&(a.acf_map=l.acf_fields.filter(r=>r.required).map(r=>({formField:"",acfField:r.key,required:r.required})),a.acf_map.length<1&&(a.acf_map=[{}])),l!=null&&l.mb_fields&&(a.metabox_map=l.mb_fields.filter(r=>r.required).map(r=>({formField:"",metaboxField:r.key,required:r.required})),a.metabox_map.length<1&&(a.metabox_map=[{}])),l!=null&&l.je_cpt_fields&&(a.je_cpt_meta_map=l.je_cpt_fields.filter(r=>r.required).map(r=>({formField:"",jeCPTField:r.key,required:r.required}))),a.je_cpt_meta_map.length<1&&(a.je_cpt_meta_map=[{}])}),b(a)},k=t=>{if(setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),!ne(n)){p({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}if(!n.post_type){p({show:!0,msg:s("Post Type can't be empty","bit-integrations")});return}if(!n.post_status){p({show:!0,msg:s("Post Status can't be empty","bit-integrations")});return}if(t===3){if(!le(n)){p({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}if(!re(n)){p({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}if(!oe(n)){p({show:!0,msg:s("Please map mandatory fields","bit-integrations")});return}}T(t)},G=()=>{_(!0),Z(c,o,P,n,S,"","",_).then(i=>{var a;i.success?(p({show:!0,msg:(a=i.data)==null?void 0:a.msg}),S(P)):p({show:!0,msg:i.data||i})})};return e.jsxs("div",{children:[e.jsx(X,{snack:A,setSnackbar:p}),(d==null?void 0:d.youTubeLink)&&e.jsx(M,{title:"WP Post Creation",youTubeLink:d==null?void 0:d.youTubeLink}),(d==null?void 0:d.docLink)&&e.jsx(M,{title:"WP Post Creation",docLink:d==null?void 0:d.docLink}),e.jsx("div",{className:"txt-center mt-2",children:e.jsx(ee,{step:3,active:h})}),e.jsxs("div",{className:"btcd-stp-page",style:{width:h===1&&900,height:h===1&&"auto"},children:[e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:s("Integration Name","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>f(t.target.name,t.target.value),name:"name",value:n.name,type:"text",placeholder:s("Integration Name...","bit-integrations")}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:s("Post Type","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:[s("Select one of the defined WordPress post types Or custom post types for the post","bit-integrations"),e.jsx("br",{})]})})]}),e.jsxs("div",{children:[e.jsxs("select",{name:"post_type",onChange:t=>B(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"bit-integrations"}),g==null?void 0:g.map((t,i)=>e.jsx("option",{value:t==null?void 0:t.id,children:t==null?void 0:t.title},`acf-${i*2}`))]}),e.jsx("button",{onClick:()=>te(g,y),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${s("Refresh Post Types","bit-integrations")}'`},type:"button",children:"â†»"})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:s("Post Status","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:[s("Select the status for the post. If published status is selected and the post date is in the future, it will automatically be changed to scheduled","bit-integrations"),e.jsx("br",{})]})})]}),e.jsxs("select",{name:"post_status",onChange:t=>f(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:s("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:s("Publish","bit-integrations")}),e.jsx("option",{value:"draft",children:s("Draft","bit-integrations")}),e.jsx("option",{value:"auto-draft",children:s("Auto-Draft","bit-integrations")}),e.jsx("option",{value:"private",children:s("Private","bit-integrations")}),e.jsx("option",{value:"pending",children:s("Pending","bit-integrations")})]}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:s("Author","bit-integrations")}),e.jsx(N,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:["bit-integrations",e.jsx("br",{})]})})]}),e.jsx("div",{children:e.jsxs("select",{name:"post_author",onChange:t=>f(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:s("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),j==null?void 0:j.map((t,i)=>e.jsx("option",{value:t.ID,children:t.display_name},`acf-${i*2}`))]})}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:s("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>f(t.target.name,t.target.value),className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:s("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:s("Open","bit-integrations")}),e.jsx("option",{value:"closed",children:s("Closed","bit-integrations")})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:s("Post Field Mapping","bit-integrations")})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:s("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:s("Post Fields","bit-integrations")})})]})]}),(w=n==null?void 0:n.post_map)==null?void 0:w.map((t,i)=>e.jsx(se,{i,type:"post",field:t,formFields:m,postConf:n,setPostConf:b,customFields:I},`analytics-m-${i+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>ie("post_map",n.post_map.length,n,b),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("button",{onClick:()=>k(2),className:"btn f-right btcd-btn-lg purple sh-sm flx",type:"button",children:[s("Next","bit-integrations"),e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),e.jsxs("div",{className:"btcd-stp-page",style:x({},h===2&&{width:900,height:"auto",overflow:"visible"}),children:[e.jsx(ae,{formID:D,formFields:m,handleInput:t=>f(t,n),postConf:n,setPostConf:b,isLoading:F,setIsLoading:_,setSnackbar:p,acfFields:E,mbFields:$,jeCPTFields:J}),e.jsxs("button",{onClick:()=>k(3),className:"btn f-right btcd-btn-lg purple sh-sm flx",type:"button",children:[s("Next","bit-integrations"),e.jsx("div",{className:"btcd-icn icn-arrow_back rev-icn d-in-b"})]})]}),e.jsx(Y,{step:h,saveConfig:()=>G(),isLoading:F,dataConf:n,setDataConf:b,formFields:m})]})}export{je as default};

var R=Object.defineProperty;var w=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var y=(l,r,t)=>r in l?R(l,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[r]=t,o=(l,r)=>{for(var t in r||(r={}))V.call(r,t)&&y(l,t,r[t]);if(w)for(var t of w(r))$.call(r,t)&&y(l,t,r[t]);return l};import{j as e,i as q,r as I,L as K}from"./main-165.js";import{H as L,_ as d,j as E,k as O,l as P,m as B,e as G,n as v}from"./bi.312.95.js";import{g as H,a as S,b as p,d as T,e as _,f as A}from"./bi.878.908.js";import{T as U}from"./bi.953.732.js";const u=(l,r,t)=>{const a=o({},r);a.field_map.splice(l,0,{}),t(o({},a))},z=(l,r,t)=>{const a=o({},r);a.field_map.length>1&&a.field_map.splice(l,1),t(o({},a))},M=(l,r,t,a)=>{const i=o({},t);i.field_map[r][l.target.name]=l.target.value,l.target.value==="custom"&&(i.field_map[r].customValue=""),l.target.value==="customFieldKey"&&(i.field_map[r].customFieldKey=""),a(o({},i))},D=(l,r,t,a,i)=>{const n=o({},t);n.field_map[r][i]=l.target.value,a(o({},n))};function J({field:l,index:r,conf:t,setConf:a,fieldValue:i,fieldLabel:n,className:b}){return e.jsx(L,{onChange:c=>D(c,r,t,a,i),label:d(n,"bit-integrations"),className:b,type:"text",value:l[i],placeholder:d(n,"bit-integrations")})}function Q({i:l,formFields:r,field:t,clickupConf:a,setClickupConf:i}){var g,F;let n=[];a.actionName==="task"&&(n=a==null?void 0:a.taskFields);const b=n.filter(s=>s.required===!0)||[],j=[...n.filter(s=>s.required===!1)||[],...(a==null?void 0:a.customFields)||[]];if(((g=a==null?void 0:a.field_map)==null?void 0:g.length)===1&&t.clickupFormField===""){const s=o({},a),m=H(s);s.field_map=m,i(s)}const h=q(E),{isPro:N}=h;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:t.formField||"",onChange:s=>M(s,l,a,i),children:[e.jsx("option",{value:"",children:d("Select Field","bit-integrations")}),e.jsx("optgroup",{label:d("Form Fields","bit-integrations"),children:r==null?void 0:r.map(s=>e.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`))}),e.jsx("option",{value:"custom",children:d("Custom...","bit-integrations")}),e.jsx("optgroup",{label:sprintf(d("General Smart Codes %s","bit-integrations"),N?"":`(${d("Pro","bit-integrations")})`),children:N&&((F=O)==null?void 0:F.map(s=>e.jsx("option",{value:s.name,children:s.label},`ff-rm-${s.name}`)))})]}),t.formField==="custom"&&e.jsx(U,{onChange:s=>P(s,l,a,i),label:d("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:t.customValue,placeholder:d("Custom Value","bit-integrations"),formFields:r}),e.jsxs("select",{className:"btcd-paper-inp",disabled:l<b.length,name:"clickupFormField",value:l<b?b[l].label||"":t.clickupFormField||"",onChange:s=>M(s,l,a,i),children:[e.jsx("option",{value:"",children:d("Select Field","bit-integrations")}),l<b.length?e.jsx("option",{value:b[l].key,children:b[l].label},b[l].key):j.map(({key:s,label:m})=>e.jsx("option",{value:s,children:m},s)),a.actionName==="task"&&e.jsx("option",{value:"customFieldKey",children:d("Custom Field","bit-integrations")})]}),t.clickupFormField==="customFieldKey"&&e.jsx(J,{field:t,index:l,conf:a,setConf:i,fieldValue:"customFieldKey",fieldLabel:"Custom Field Key",className:"ml-2"})]}),l>=b.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>u(l,a,i),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>z(l,a,i),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function W({clickupConf:l,setClickupConf:r,formFields:t,loading:a,setLoading:i}){const[n,b]=I.useState({show:!1,action:()=>{}}),c=()=>{b({show:!1})},j=(h,N)=>{const g=o({},l);g[N]=h,r(o({},g))};return e.jsxs("div",{className:"pos-rel d-flx flx-wrp",children:[e.jsx(B,{checked:(l==null?void 0:l.attachment)||!1,onChange:()=>b({show:"attachment"}),className:"wdt-200 mt-4 mr-2",value:"attachment",title:d("Add Attachment","bit - integrations"),subTitle:d("Add attachment in the task")}),e.jsxs(G,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:d("Ok","bit-integrations"),show:n.show==="attachment",close:c,action:c,title:d("Select file upload field","bit-integrations"),children:[e.jsx("div",{className:"btcd-hr mt-2"}),e.jsx("div",{className:"mt-2",children:d("Select file upload field","bit-integrations")}),e.jsx(v,{defaultValue:l==null?void 0:l.attachment,className:"mt-2 w-9",onChange:h=>j(h,"attachment"),options:t.filter(h=>h.type==="file").map(h=>({label:h.label,value:h.name})),closeOnSelect:!0})]})]})}function C({formFields:l,handleInput:r,clickupConf:t,setClickupConf:a,loading:i,setLoading:n,setSnackbar:b}){var h,N,g,F;const c=s=>{const m=o({},t);m.field_map=[{formField:"",clickupFormField:""}];const{name:x}=s.target;s.target.value!==""?(m[x]=s.target.value,s.target.value==="task"&&(m.selectedTeam!=""||m.selectedTeam!=null)&&S(m,a,n)):delete m[x],a(o({},m))},j=(s,m)=>{const x=o({},t);x[m]=s,m==="selectedList"&&s!==""&&t.actionName==="task"?A(x,a,n):m==="selectedFolder"&&s!==""&&t.actionName==="task"?_(x,a,n):m==="selectedSpace"&&s!==""&&t.actionName==="task"?T(x,a,n):m==="selectedTeam"&&s!==""&&t.actionName==="task"&&p(x,a,n),a(o({},x))};return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-200 d-in-b",children:d("Select Action:","bit-integrations")}),e.jsxs("select",{onChange:c,name:"actionName",value:t.actionName,className:"btcd-paper-inp w-5",children:[e.jsx("option",{value:"",children:d("Select an action","bit-integrations")}),e.jsx("option",{value:"task",children:d("Create Task","bit-integrations")})]}),t.actionName==="task"&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:d("Select Team:","bit-integrations")}),e.jsx(v,{options:(h=t==null?void 0:t.Teams)==null?void 0:h.map(s=>({label:s.name,value:s.id})),className:"msl-wrp-options dropdown-custom-width",defaultValue:t==null?void 0:t.selectedTeam,onChange:s=>j(s,"selectedTeam"),disabled:i.Teams,singleSelect:!0}),e.jsx("button",{onClick:()=>S(t,a,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${d("Refresh teams","bit-integrations")}'`},type:"button",disabled:i.Teams,children:"↻"})]})]}),t.actionName==="task"&&t.selectedTeam&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:d("Select Space:","bit-integrations")}),e.jsx(v,{options:(N=t==null?void 0:t.Spaces)==null?void 0:N.map(s=>({label:s.name,value:s.id})),className:"msl-wrp-options dropdown-custom-width",defaultValue:t==null?void 0:t.selectedSpace,onChange:s=>j(s,"selectedSpace"),disabled:i.Spaces,singleSelect:!0}),e.jsx("button",{onClick:()=>p(t,a,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${d("Refresh spaces","bit-integrations")}'`},type:"button",disabled:i.Spaces,children:"↻"})]})]}),t.actionName==="task"&&t.selectedSpace&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:d("Select Folder:","bit-integrations")}),e.jsx(v,{options:(g=t==null?void 0:t.Folders)==null?void 0:g.map(s=>({label:s.name,value:s.id})),className:"msl-wrp-options dropdown-custom-width",defaultValue:t==null?void 0:t.selectedFolder,onChange:s=>j(s,"selectedFolder"),disabled:i.Folders,singleSelect:!0}),e.jsx("button",{onClick:()=>T(t,a,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${d("Refresh folders","bit-integrations")}'`},type:"button",disabled:i.Folders,children:"↻"})]})]}),t.actionName==="task"&&t.selectedFolder&&e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-200 d-in-b",children:d("Select List:","bit-integrations")}),e.jsx(v,{options:(F=t==null?void 0:t.Lists)==null?void 0:F.map(s=>({label:s.name,value:s.id})),className:"msl-wrp-options dropdown-custom-width",defaultValue:t==null?void 0:t.selectedList,onChange:s=>j(s,"selectedList"),disabled:i.Lists,singleSelect:!0}),e.jsx("button",{onClick:()=>_(t,a,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${d("Refresh Lists","bit-integrations")}'`},type:"button",disabled:i.Lists,children:"↻"})]})]}),(i.Teams||i.Spaces||i.Folders||i.Lists||i.customFields)&&e.jsx(K,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),t.actionName==="task"&&e.jsxs("div",{children:[e.jsx("br",{}),e.jsxs("div",{className:"mt-5",children:[e.jsx("b",{className:"wdt-100",children:d("Field Map","bit-integrations")}),e.jsx("button",{onClick:()=>A(t,a,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${d("Refresh fields","bit-integrations")}'`},type:"button",disabled:i.Lists,children:"↻"})]}),e.jsx("br",{}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:d("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:d("Clickup Fields","bit-integrations")})})]}),t==null?void 0:t.field_map.map((s,m)=>e.jsx(Q,{i:m,field:s,clickupConf:t,formFields:l,setClickupConf:a,setSnackbar:b},`rp-m-${m+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>u(t.field_map.length,t,a),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:d("Utilities","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(W,{clickupConf:t,setClickupConf:a,formFields:l,loading:i,setLoading:n})]})]})}export{C};

var B=Object.defineProperty,D=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var I=(e,l,a)=>l in e?B(e,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[l]=a,h=(e,l)=>{for(var a in l||(l={}))U.call(l,a)&&I(e,a,l[a]);if(S)for(var a of S(l))z.call(l,a)&&I(e,a,l[a]);return e},F=(e,l)=>D(e,G(l));import{i as J,j as t,r as V,L as f}from"./main-165.js";import{b as K,c as k,_ as n,j as Q,k as W,l as X,m as $,e as q,n as L}from"./bi.312.95.js";import{h as R,a as O,d as Y}from"./bi.97.843.js";import{T as Z}from"./bi.953.732.js";const at=(e,l,a)=>{const s=h({},l),{name:d}=e.target;e.target.value!==""?s[d]=e.target.value:delete s[d],a(h({},s))},lt=e=>!((e!=null&&e.field_map?e.field_map.filter(a=>a.formField===""||a.salesflareFormField===""||a.formField==="custom"&&a.customValue===""||a.salesflareFormField==="customFieldKey"&&a.customFieldKey===""):[]).length>0),P=e=>{const l=e==null?void 0:e.leadFields.filter(a=>a.required===!0);return l.length>0?l.map(a=>({formField:"",propovoiceCrmFormField:a.key})):[{formField:"",propovoiceCrmFormField:""}]},H=(e,l,a,s)=>{s(F(h({},a),{tags:!0})),K(null,"propovoice_crm_lead_tags").then(d=>{if(d&&d.success){l(c=>{const b=h({},c);return b.default||(b.default={}),d.data&&(b.default.allTags=d.data),b}),s(F(h({},a),{tags:!1})),k.success(n("All tags fetched successfully","bit-integrations"));return}s(F(h({},a),{tags:!1})),k.error(n("Propovoice Crm tags fetch failed. please try again","bit-integrations"))}).catch(()=>s(F(h({},a),{tags:!1})))},E=(e,l,a,s)=>{s(F(h({},a),{label:!0})),K(null,"propovoice_crm_lead_label").then(d=>{if(d&&d.success){l(c=>{const b=h({},c);return b.default||(b.default={}),d.data&&(b.default.allLabels=d.data),b}),s(F(h({},a),{label:!1})),k.success(n("All label fetched successfully","bit-integrations"));return}s(F(h({},a),{label:!1})),k.error(n("Propovoice Crm label fetch failed. please try again","bit-integrations"))}).catch(()=>s(F(h({},a),{label:!1})))};function v({i:e,field:l,formFields:a,propovoiceCrmConf:s,setPropovoiceCrmConf:d}){var x,g,N,y;if(((x=s==null?void 0:s.field_map)==null?void 0:x.length)===1&&l.propovoiceCrmFormField===""){const i=h({},s),w=P(i);i.field_map=w,d(i)}const c=((g=s==null?void 0:s.leadFields)==null?void 0:g.filter(i=>i.required===!0))||[],b=((N=s==null?void 0:s.leadFields)==null?void 0:N.filter(i=>i.required===!1))||[],m=J(Q),{isPro:r}=m;return t.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:t.jsxs("div",{className:"pos-rel flx",children:[t.jsxs("div",{className:"flx integ-fld-wrp",children:[t.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:l.formField||"",onChange:i=>R(i,e,s,d),children:[t.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),t.jsx("optgroup",{label:n("Form Fields","bit-integrations"),children:a==null?void 0:a.map(i=>t.jsx("option",{value:i.name,children:i.label},`ff-rm-${i.name}`))}),t.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),t.jsx("optgroup",{label:sprintf(n("General Smart Codes %s","bit-integrations"),r?"":`(${n("Pro","bit-integrations")})`),children:r&&((y=W)==null?void 0:y.map(i=>t.jsx("option",{value:i.name,children:i.label},`ff-rm-${i.name}`)))})]}),l.formField==="custom"&&t.jsx(Z,{onChange:i=>X(i,e,s,d),label:n("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:l.customValue,placeholder:n("Custom Value","bit-integrations"),formFields:a}),t.jsxs("select",{className:"btcd-paper-inp",disabled:e<c.length,name:"propovoiceCrmFormField",value:e<c.length?c[e].key||"":l.propovoiceCrmFormField||"",onChange:i=>R(i,e,s,d),children:[t.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),e<c.length?t.jsx("option",{value:c[e].key,children:c[e].label},c[e].key):b.map(({key:i,label:w})=>t.jsx("option",{value:i,children:w},i))]})]}),e>=c.length&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>O(e,s,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),t.jsx("button",{onClick:()=>Y(e,s,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:t.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function p({propovoiceCrmConf:e,setPropovoiceCrmConf:l,formFields:a,isLoading:s,setIsLoading:d}){var y,i,w,A;const[c,b]=V.useState({show:!1,action:()=>{}}),[m,r]=V.useState({tags:!1,label:!1}),x=(u,_)=>{var M,T;const j=h({},e);_==="tags"?(M=u.target)!=null&&M.checked?(j.actions.tags=!0,H(j,l,m,r),b({show:"tags"})):(b({show:!1}),delete j.actions.tags):_==="label"&&((T=u.target)!=null&&T.checked?(j.actions.label=!0,E(j,l,m,r),b({show:"label"})):(b({show:!1}),delete j.actions.label)),l(h({},j))},g=()=>{b({show:!1})},N=(u,_)=>{const j=h({},e);_==="tags"?j.tags=u:_==="label"&&(j.label=u),l(j)};return t.jsxs("div",{className:"pos-rel d-flx w-8",children:[t.jsx($,{checked:((y=e==null?void 0:e.actions)==null?void 0:y.tags)||!1,onChange:u=>x(u,"tags"),className:"wdt-200 mt-4 mr-2",value:"tags",title:n("Add tags","bit-integrations"),subTitle:n("tags add lead","bit-integrations")}),t.jsx($,{checked:((i=e==null?void 0:e.actions)==null?void 0:i.label)||!1,onChange:u=>x(u,"label"),className:"wdt-200 mt-4 mr-2",value:"label",title:n("Add label","bit-integrations"),subTitle:n("label add lead","bit-integrations")}),t.jsxs(q,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:n("Ok","bit-integrations"),show:c.show==="tags",close:g,action:g,title:n("Tags","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:n("Select tag","bit-integrations")}),m!=null&&m.tags?t.jsx(f,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(L,{options:(w=e==null?void 0:e.default)!=null&&w.allTags?e.default.allTags.map(u=>({label:u.name,value:u.term_id})):[],className:"msl-wrp-options",defaultValue:e==null?void 0:e.tags,onChange:u=>N(u,"tags")}),t.jsx("button",{onClick:()=>H(e,l,m,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${n("Refresh Tags","bit-integrations")}'`},type:"button",children:"↻"})]})]}),t.jsxs(q,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:n("Ok","bit-integrations"),show:c.show==="label",close:g,action:g,title:n("Label","bit-integrations"),children:[t.jsx("div",{className:"btcd-hr mt-2 mb-2"}),t.jsx("div",{className:"mt-2",children:n("Select label","bit-integrations")}),m!=null&&m.label?t.jsx(f,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):t.jsxs("div",{className:"flx flx-between mt-2",children:[t.jsx(L,{options:(A=e==null?void 0:e.default)!=null&&A.allLabels?e.default.allLabels.map(u=>({label:u.name,value:u.term_id})):[],singleSelect:!0,className:"msl-wrp-options",defaultValue:e==null?void 0:e.label,onChange:u=>N(u,"label")}),t.jsx("button",{onClick:()=>E(e,l,m,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${n("Refresh Label","bit-integrations")}'`},type:"button",children:"↻"})]})]})]})}function nt({formID:e,formFields:l,handleInput:a,propovoiceCrmConf:s,setPropovoiceCrmConf:d,isLoading:c,setIsLoading:b,setSnackbar:m}){const r=x=>{const g=h({},s),{name:N}=x.target;x.target.value!==""?g[N]=x.target.value:delete g[N],g[x.target.name]=x.target.value,d(h({},g))};return t.jsxs(t.Fragment,{children:[t.jsx("br",{}),t.jsx("b",{className:"wdt-200 d-in-b",children:n("Actions:","bit-integrations")}),t.jsxs("select",{onChange:r,name:"mainAction",value:s==null?void 0:s.mainAction,className:"btcd-paper-inp w-5",children:[t.jsx("option",{value:"",children:n("Select Actions","bit-integrations")}),(s==null?void 0:s.allActions)&&s.allActions.map(({key:x,label:g})=>t.jsx("option",{value:x,children:g},x))]}),t.jsx("br",{}),t.jsx("br",{}),c&&t.jsx(f,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.mainAction&&!c&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:n("Map Fields","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:n("Form Fields","bit-integrations")})}),t.jsx("div",{className:"txt-dp",children:t.jsx("b",{children:n("Propovice CRM Fields","bit-integrations")})})]}),s.field_map.map((x,g)=>t.jsx(v,{i:g,field:x,formFields:l,propovoiceCrmConf:s,setPropovoiceCrmConf:d},`keap-m-${g+9}`)),t.jsx("br",{}),t.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:t.jsx("button",{onClick:()=>O(s.field_map.length,s,d),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),t.jsx("div",{className:"mt-4",children:t.jsx("b",{className:"wdt-100",children:n("Utilities","bit-integrations")})}),t.jsx("div",{className:"btcd-hr mt-1"}),t.jsx(p,{propovoiceCrmConf:s,setPropovoiceCrmConf:d,formFields:l,isLoading:c,setIsLoading:b})]})}export{nt as P,lt as c,at as h};

var z=Object.defineProperty;var I=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var k=(c,d,o)=>d in c?z(c,d,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[d]=o,x=(c,d)=>{for(var o in d||(d={}))B.call(d,o)&&k(c,o,d[o]);if(I)for(var o of I(d))H.call(d,o)&&k(c,o,d[o]);return c};import{r,e as $,i as J,l as K,u as Q,j as e}from"./main-165.js";import{g as V,$ as W,h as X,b as j,d as Y,_ as i,i as Z,I as ee,s as te}from"./bi.312.95.js";import{p as se}from"./bi.784.760.js";import{P as g,a as f,c as ie,b as ae}from"./bi.292.761.js";import"./bi.953.732.js";import"./bi.422.733.js";function me({allIntegURL:c}){var N,y,P;const[d,o]=r.useState([]),[M,O]=r.useState([]),[s,p]=$(V),[v,T]=$(W),b=J(X);r.useState([]),K();const E=Q(),[D,_]=r.useState([]),[A,F]=r.useState([]),[q,m]=r.useState({show:!1}),[L,R]=r.useState(!1);r.useEffect(()=>{j({},"pods/list",null,"GET").then(t=>{var a,l;t!=null&&t.success&&t!==void 0&&(o(Object.values((a=t.data)==null?void 0:a.post_types)),O((l=t.data)==null?void 0:l.users))}),j({post_type:s==null?void 0:s.post_type},"pods/fields").then(t=>{var a,l;t!=null&&t.success&&t!==void 0&&(_(Object.values((a=t==null?void 0:t.data)==null?void 0:a.podFields)),F(Object.values((l=t==null?void 0:t.data)==null?void 0:l.podFiles)))})},[]);const h=(t,a,l)=>{const n=x({},s);l?n[t]=Number(a):n[t]=a,p(n)},U=(t,a)=>{const l=x({},s);l[t]=a,j({post_type:a},"pods/fields").then(n=>{var C,S,w;n!=null&&n.success&&n!==void 0&&(_(Object.values((C=n==null?void 0:n.data)==null?void 0:C.podFields)),F(Object.values((S=n==null?void 0:n.data)==null?void 0:S.podFiles)),n!=null&&n.data&&(l.pod_map=Object.values(n.data).filter(u=>u.required).map(u=>({formField:"",podField:u.key,required:u.required})),((w=l==null?void 0:l.pod_map)==null?void 0:w.length)<1&&(l.pod_map=[{}])),p(l))})},G=()=>{if(!ie(s)){m({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}if(!ae(s)){m({show:!0,msg:i("Please map mandatory fields","bit-integrations")});return}te({flow:v,setFlow:T,allIntegURL:c,conf:s,navigate:E,edit:1,setIsLoading:R,setSnackbar:m})};return e.jsxs("div",{style:{width:900},children:[e.jsx(Y,{snack:q,setSnackbar:m}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Integration Name","bit-integrations")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>h(t.target.name,t.target.value),name:"name",value:s.name,type:"text",placeholder:i("Integration Name...","bit-integrations")}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(Z,{entity:v.triggered_entity,setSnackbar:m}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Post Type","bit-integrations")})}),e.jsxs("select",{name:"post_type",onChange:t=>U(t.target.name,t.target.value),value:s==null?void 0:s.post_type,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:"Select type"}),d.map((t,a)=>e.jsx("option",{value:t.name,children:t.label},`pod-${a*2}`))]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Post Status","bit-integrations")})}),e.jsxs("select",{name:"post_status",onChange:t=>h(t.target.name,t.target.value),value:s==null?void 0:s.post_status,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Status","bit-integrations")}),e.jsx("option",{value:"publish",children:i("Publish","bit-integrations")}),e.jsx("option",{value:"draft",children:i("Draft","bit-integrations")}),e.jsx("option",{value:"inherit",children:i("Inherit","bit-integrations")}),e.jsx("option",{value:"auto-draft",children:i("Auto-Draft","bit-integrations")}),e.jsx("option",{value:"private ",children:i("Private","bit-integrations")}),e.jsx("option",{value:"pending",children:i("Pending","bit-integrations")})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Comment Status","bit-integrations")})}),e.jsxs("select",{name:"comment_status",onChange:t=>h(t.target.name,t.target.value),value:s==null?void 0:s.comment_status,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Status","bit-integrations")}),e.jsx("option",{value:"open",children:i("Open","bit-integrations")}),e.jsx("option",{value:"closed",children:i("Closed","bit-integrations")})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:i("Author","bit-integrations")})}),e.jsxs("select",{name:"post_author",onChange:t=>h(t.target.name,t.target.value),value:s==null?void 0:s.post_author,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:i("Select Author","bit-integrations")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),M.map((t,a)=>e.jsx("option",{value:t.ID,children:t.display_name},`pod-${a*2}`))]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:i("Post Fields Mapping","bit-integrations")})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Post Fields","bit-integrations")})})]})]}),(N=s==null?void 0:s.post_map)==null?void 0:N.map((t,a)=>e.jsx(g,{i:a,type:"post",field:t,formFields:b,podsConf:s,setPodsConf:p,podFields:se,fieldType:"fields"},`analytics-m-${a+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>f("post_map",s.post_map.length,s,p),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod Fields Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Pod Fields","bit-integrations")})})]})]}),(y=s==null?void 0:s.pod_field_map)==null?void 0:y.map((t,a)=>e.jsx(g,{i:a,type:"pod",field:t,formFields:b,podsConf:s,setPodsConf:p,podFields:D,fieldType:"fields"},`analytics-m-${a+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>f("pod_field_map",s.pod_field_map.length,s,p),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:"Pod File Upload Mapping"})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Form Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:i("Pod Fields","bit-integrations")})})]})]}),(P=s==null?void 0:s.pod_file_map)==null?void 0:P.map((t,a)=>e.jsx(g,{i:a,type:"podFile",field:t,formFields:b,podsConf:s,setPodsConf:p,podFields:A,fieldType:"file"},`analytics-m-${a+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>f("pod_file_map",s.pod_file_map.length,s,p),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),e.jsx(ee,{edit:!0,saveConfig:G,isLoading:L,dataConf:s,setDataConf:p,formFields:b})]})}export{me as default};

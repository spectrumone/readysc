var g=Object.defineProperty;var w=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var y=(l,s,d)=>s in l?g(l,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[s]=d,m=(l,s)=>{for(var d in s||(s={}))R.call(s,d)&&y(l,d,s[d]);if(w)for(var d of w(s))q.call(s,d)&&y(l,d,s[d]);return l};import{j as e,i as V,L}from"./main-165.js";import{m as S,_ as a,j as T,k as U,H,T as P,o as A}from"./bi.312.95.js";import{g as B,r as E,a as I}from"./bi.948.922.js";function G({campaignMonitorConf:l,setCampaignMonitorConf:s}){var i;const d=(c,n)=>{const r=m({},l);n==="update"&&(c.target.checked?r.actions.update=!0:delete r.actions.update),s(m({},r))};return e.jsx("div",{className:"pos-rel d-flx w-8",children:e.jsx(S,{checked:((i=l.actions)==null?void 0:i.update)||!1,onChange:c=>d(c,"update"),className:"wdt-200 mt-4 mr-2",value:"user_share",title:a("Update CampaignMonitor","bit-integrations"),subTitle:a("Update Responses with CampaignMonitor existing email?","bit-integrations")})})}function o({i:l,formFields:s,field:d,campaignMonitorConf:i,setCampaignMonitorConf:c}){var v,_;let n=i.subscriberFields;const r=n.filter(t=>t.required===!0)||[],p=[...n.filter(t=>t.required===!1)||[],...(i==null?void 0:i.customFields)||[]],b=V(T),{isPro:h}=b;((v=i==null?void 0:i.field_map)==null?void 0:v.length)===1&&d.campaignMonitorField===""&&c(t=>(t.field_map=B(t),t));const j=t=>{const u=m({},i);u.field_map.splice(t,0,{}),c(u)},k=t=>{const u=m({},i);u.field_map.length>1&&u.field_map.splice(t,1),c(u)},N=(t,u)=>{const x=m({},i);x.field_map[u][t.target.name]=t.target.value,t.target.value==="custom"&&(x.field_map[u].customValue=""),c(x)},$=(t,u)=>{const x=m({},i);x.field_map[u].customValue=t.target.value,c(x)};return e.jsxs("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:d.formField||"",onChange:t=>N(t,l),children:[e.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),e.jsx("optgroup",{label:a("List Fields","bit-integrations"),children:s==null?void 0:s.map(t=>e.jsx("option",{value:t.name,children:t.label},`ff-rm-${t.name}`))}),e.jsx("option",{value:"custom",children:a("Custom...","bit-integrations")}),e.jsx("optgroup",{label:`${a("General Smart Codes","bit-integrations")} ${h?"":`(${a("Pro","bit-integrations")})`}`,children:h&&((_=U)==null?void 0:_.map(t=>e.jsx("option",{value:t.name,children:t.label},`ff-rm-${t.name}`)))})]}),d.formField==="custom"&&e.jsx(H,{onChange:t=>$(t,l),label:a("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:d.customValue,placeholder:a("Custom Value","bit-integrations")}),e.jsxs("select",{className:"btcd-paper-inp",name:"campaignMonitorField",value:l<r.length?r[l].key||"":d.campaignMonitorField||"",onChange:t=>N(t,l),disabled:l<r.length,children:[e.jsx("option",{value:"",children:a("Select Field","bit-integrations")}),l<r.length?e.jsx("option",{value:r[l].key,children:r[l].label},r[l].key):p.map(({key:t,label:u})=>e.jsx("option",{value:t,children:u},t))]})]}),l>=r.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>j(l),className:"icn-btn sh-sm ml-2",type:"button",children:"+"}),e.jsx("button",{onClick:()=>k(l),className:"icn-btn sh-sm ml-2",type:"button","aria-label":"btn",children:e.jsx(P,{})})]})]})}function O({formFields:l,campaignMonitorConf:s,setCampaignMonitorConf:d,isLoading:i,setIsLoading:c,setSnackbar:n}){var F,p;const r=b=>{const h=b.target.value,j=m({},s);h&&(j.listId=h),d(j),I(j,d,c,n)};return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-200 d-in-b",children:a("Subscriber List:","bit-integrations")}),e.jsxs("select",{value:s==null?void 0:s.listId,name:"listId",id:"",className:"btcd-paper-inp w-5",onChange:r,children:[e.jsx("option",{value:"",children:a("Select Subscriber List","bit-integrations")}),((F=s==null?void 0:s.default)==null?void 0:F.campaignMonitorLists)&&s.default.campaignMonitorLists.map(b=>e.jsx("option",{value:b.listId,children:b.listName},`${b.listId}`))]}),e.jsx("button",{onClick:()=>E(s,d,c,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh CampaignMonitor campaign"'},type:"button",disabled:i,children:"↻"}),e.jsx("br",{}),e.jsx("br",{}),i&&e.jsx(L,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,translist:"scale(0.7)"}}),e.jsxs("div",{className:"mt-4",children:[e.jsx("b",{className:"wdt-100",children:a("Map Fields","bit-integrations")}),e.jsx("button",{onClick:()=>I(s,d,c,n),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh CampaignMonitor Field","bit-integrations")}'`},type:"button",disabled:i,children:"↻"})]}),!i&&((s==null?void 0:s.listId)||((p=s==null?void 0:s.default)==null?void 0:p.fields))&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("List Fields","bit-integrations")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("CampaignMonitor Fields","bit-integrations")})})]}),s.field_map.map((b,h)=>e.jsx(o,{i:h,field:b,campaignMonitorConf:s,formFields:l,setCampaignMonitorConf:d},`CampaignMonitor-m-${h+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>A(s.field_map.length,s,d),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:a("Utilities","bit-integrations")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(G,{campaignMonitorConf:s,setCampaignMonitorConf:d})]})]})}export{O as C};

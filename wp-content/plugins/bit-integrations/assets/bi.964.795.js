var M=Object.defineProperty;var N=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var F=(t,c,a)=>c in t?M(t,c,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[c]=a,l=(t,c)=>{for(var a in c||(c={}))k.call(c,a)&&F(t,a,c[a]);if(N)for(var a of N(c))A.call(c,a)&&F(t,a,c[a]);return t};import{r as o,j as s,L as _,i as S}from"./main-165.js";import{m as $,_ as n,e as B,n as I,j as V,k as P,o as R}from"./bi.312.95.js";import{g as q,f as w,a as L}from"./bi.791.796.js";import{T as E}from"./bi.953.732.js";function H({trelloConf:t,setTrelloConf:c,formFields:a}){var e;const[i,d]=o.useState(!1),[m,r]=o.useState({show:!1,action:()=>{}}),u=(b,j)=>{var v;const g=l({},t);j==="tag"&&((v=b.target)!=null&&v.checked?(g.actions.tag=!0,r({show:"tag"})):(r({show:!1}),delete g.actions.tag)),c(l({},g))},h=()=>{r({show:!1})},x=b=>{const j=l({},t);j.pos=b,c(j)},p=[{label:"Top",value:"top"},{label:"Bottom",value:"bottom"}];return s.jsxs("div",{className:"pos-rel d-flx w-8",children:[s.jsx($,{checked:((e=t==null?void 0:t.actions)==null?void 0:e.tag)||!1,onChange:b=>u(b,"tag"),className:"wdt-200 mt-4 mr-2",value:"tag",title:n("Add Position","bit-integrations"),subTitle:n("Add Card Position","bit-integrations")}),s.jsxs(B,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"purple",btnTxt:n("Ok","bit-integrations"),show:m.show==="tag",close:h,action:h,title:n("Position","bit-integrations"),children:[s.jsx("div",{className:"btcd-hr mt-2 mb-2"}),s.jsx("div",{className:"mt-2",children:n("Select Card Position","bit-integrations")}),i?s.jsx(_,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):s.jsx("div",{className:"flx flx-between mt-2",children:s.jsx(I,{options:p,className:"msl-wrp-options",singleSelect:!0,defaultValue:t.pos,onChange:b=>x(b)})})]})]})}const G=(t,c,a)=>{const i=l({},c);i.field_map.splice(t,0,{}),a(l({},i))},O=(t,c,a)=>{const i=l({},c);i.field_map.length>1&&i.field_map.splice(t,1),a(l({},i))},y=(t,c,a,i)=>{const d=l({},a);d.field_map[c][t.target.name]=t.target.value,t.target.value==="custom"&&(d.field_map[c].customValue=""),i(l({},d))},T=(t,c,a,i)=>{const d=l({},a);d.field_map[c].customValue=t,i(l({},d))};function U({i:t,formFields:c,field:a,trelloConf:i,setTrelloConf:d}){var x,p;if(((x=i==null?void 0:i.field_map)==null?void 0:x.length)===1&&a.trelloFormField===""){const e=l({},i),b=q(e);e.field_map=b,d(e)}const m=(i==null?void 0:i.cardFields.filter(e=>e.required===!0))||[],r=(i==null?void 0:i.cardFields.filter(e=>e.required===!1))||[],u=S(V),{isPro:h}=u;return s.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:s.jsxs("div",{className:"pos-rel flx",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:e=>y(e,t,i,d),children:[s.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),s.jsx("optgroup",{label:n("Form Fields","bit-integrations"),children:c==null?void 0:c.map(e=>s.jsx("option",{value:e.name,children:e.label},`ff-rm-${e.name}`))}),s.jsx("option",{value:"custom",children:n("Custom...","bit-integrations")}),s.jsx("optgroup",{label:sprintf(n("General Smart Codes %s","bit-integrations"),h?"":`(${n("Pro","bit-integrations")})`),children:h&&((p=P)==null?void 0:p.map(e=>s.jsx("option",{value:e.name,children:e.label},`ff-rm-${e.name}`)))})]}),a.formField==="custom"&&s.jsx(E,{onChange:e=>T(e,t,i,d),label:n("Custom Value","bit-integrations"),className:"mr-2",type:"text",value:a.customValue,placeholder:n("Custom Value","bit-integrations"),formFields:c}),s.jsxs("select",{className:"btcd-paper-inp",disabled:t<m.length,name:"trelloFormField",value:t<m.length?m[t].key||"":a.trelloFormField||"",onChange:e=>y(e,t,i,d),children:[s.jsx("option",{value:"",children:n("Select Field","bit-integrations")}),t<m.length?s.jsx("option",{value:m[t].key,children:m[t].label},m[t].key):r.map(({key:e,label:b})=>s.jsx("option",{value:e,children:b},e))]})]}),t>=m.length&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>G(t,i,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),s.jsx("button",{onClick:()=>O(t,i,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:s.jsx("span",{className:"btcd-icn icn-trash-2"})})]})]})})}function W({formFields:t,handleInput:c,trelloConf:a,setTrelloConf:i,isLoading:d,setIsLoading:m,setSnackbar:r}){var u,h,x;return o.useEffect(()=>{a!=null&&a.boardId&&w(a,i,m,r)},[a==null?void 0:a.boardId]),s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("b",{className:"wdt-200 d-in-b",children:n("Boards:","bit-integrations")}),s.jsxs("select",{onChange:c,name:"boardId",value:a.boardId,className:"btcd-paper-inp w-5",children:[s.jsx("option",{value:"",children:n("Select Board","bit-integrations")}),((u=a==null?void 0:a.default)==null?void 0:u.allBoardlist)&&a.default.allBoardlist.map(({boardId:p,boardName:e})=>s.jsx("option",{value:p,children:e},p))]}),s.jsx("button",{onClick:()=>L(a,i,m,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Fetch All Recipients","bit-integrations")}'`},type:"button",disabled:d,children:"↻"}),s.jsx("br",{}),((h=a==null?void 0:a.default)==null?void 0:h.alllists)&&s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("b",{className:"wdt-200 d-in-b",children:n("Lists:","bit-integrations")}),s.jsxs("select",{onChange:c,name:"listId",value:a.listId,className:"btcd-paper-inp w-5",children:[s.jsx("option",{value:"",children:n("Select List","bit-integrations")}),((x=a==null?void 0:a.default)==null?void 0:x.alllists)&&a.default.alllists.map(({listId:p,listName:e})=>s.jsx("option",{value:p,children:e},p))]}),s.jsx("button",{onClick:()=>w(a,i,m,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${n("Fetch All Recipients","bit-integrations")}'`},type:"button",disabled:d,children:"↻"}),s.jsx("br",{})]}),s.jsx("br",{}),d&&s.jsx(_,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.jsx("div",{className:"mt-5",children:s.jsx("b",{className:"wdt-100",children:n("Field Map","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:n("Form Fields","bit-integrations")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:n("Trello Fields","bit-integrations")})})]}),(a==null?void 0:a.listId)&&(a==null?void 0:a.field_map.map((p,e)=>s.jsx(U,{i:e,field:p,trelloConf:a,formFields:t,setTrelloConf:i,setSnackbar:r},`rp-m-${e+9}`))),s.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:s.jsx("button",{onClick:()=>R(a.field_map.length,a,i,!1),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{}),s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:n("Utilities","bit-integrations")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(H,{trelloConf:a,setTrelloConf:i,formFields:t})]})}export{W as T};
